# 拉格朗日点 - 实验报告

## 1. 实验目的简述

本实验旨在通过数值方法求解地球-月球系统中L1拉格朗日点的位置，具体目标包括：
- 理解拉格朗日点的物理意义及其在天体力学中的重要性
- 推导L1点位置满足的方程
- 实现并比较不同的数值求根方法（牛顿法、弦截法）
- 分析数值方法的收敛性和精度

## 2. 方法简述

请简要描述您实现的算法和方法，特别是：
- L1点位置方程的推导过程和物理意义
- 牛顿法和弦截法的实现策略
- 初值或初始区间的选择依据

![屏幕截图 2025-05-21 115812](https://github.com/user-attachments/assets/aa497a12-62f5-4358-a351-12a08fc5c114)


## 3. 实验结果

### 3.1 L1点位置方程可视化

请在此处粘贴您生成的L1点位置方程图像，并简要说明图中的零点位置及其物理意义。

![Figure_1](https://github.com/user-attachments/assets/39de563a-dea7-4abc-bfc7-5fbc866abbbe)


图像说明：
图中蓝色曲线表示 L1 点位置方程的函数值随r的变化情况。红色圆点标记了方程的零点位置，其对应的 r值约为 3.2605×10^8 m。该零点意味着在这个距离处，方程左右两边相等，即物体在该位置所受的地球引力、月球引力和离心力达到平衡，此位置即为地球 - 月球系统的 L1 拉格朗日点。


### 3.2 数值求解结果

请列出使用不同方法求解L1点位置的结果：

| 求解方法 | L1点位置 (m) | 相对于地月距离的比例 | 迭代次数 | 是否收敛 |
|---------|------------|-------------------|---------|--------|
| 牛顿法   |   3.26045164e+08 m |      0.848192             |      5   |    是    |
| 弦截法   |   3.26044996e+08 m |        0.848192           |    5     |    是    |
| fsolve  |    3.26045072e+08 m |         0.848192          | -       | -      |

### 3.3 不同方法的结果比较

请计算不同方法之间的结果差异：

| 比较项 | 绝对差异 (m) | 相对差异 (%) |
|-------|------------|-------------|
| 牛顿法 vs 弦截法 |1.67623739e+02 m   | 0.00005141% |
| 牛顿法 vs fsolve | 9.24189367e+01 m  | 0.00002835% |
| 弦截法 vs fsolve | 7.52048020e+01 m | 0.00002307% |

## 4. 分析与讨论

### 4.1 L1点的物理意义

请分析L1点的物理意义及其在空间任务中的应用价值：
- L1点为什么能保持卫星相对于地球和月球静止？
- 在L1点放置卫星有什么实际应用？

1.L1 点保持卫星相对静止的原因：在 L1 点，卫星所受地球引力、月球引力和离心力达到精确平衡。地球引力试图将卫星拉向地球，月球引力试图将卫星拉向月球，而离心力则是由于卫星随月球绕地球运动而产生的向外的力。这三个力的合力为零，使得卫星在该位置上能够相对地球和月球保持静止状态。


2.位于日地 L1 点的太阳与日球层天文台（SOHO），可以持续不间断地观测太阳，不受地球遮挡的影响，能够及时捕捉到太阳表面的各种活动，如太阳耀斑、日冕物质抛射等，为空间天气预报和太阳物理学研究提供了大量宝贵的数据。

### 4.2 数值方法的比较

讨论牛顿法和弦截法在求解此问题时的优缺点：
- 收敛速度比较
- 对初值/初始区间的敏感性
- 计算复杂度和实现难度
```
收敛速度：理论上牛顿法二次收敛，快于弦截法（超线性收敛）。本次实验二者迭代次数相同，或因初值 / 区间合适。
初值敏感性：牛顿法依赖初值，不当则可能发散；弦截法只需初始区间含根，对初值要求低。
计算与实现：牛顿法需算导数，计算和编程复杂；弦截法仅算函数值，实现简单，但代码逻辑稍繁。
```
### 4.3 思考题

1. 如果将地球质量M增加，L1点的位置将如何变化？请给出物理解释。

* 若地球质量 M增加，L1 点将向远离地球、靠近月球的方向移动。
* 物理解释如下：地球质量增大，其对位于 L1 点物体的引力会增强。为了维持物体在 L1 点所受的地球引力、月球引力和离心力的平衡，需要减小地球引力的影响，同时增大月球引力和离心力的作用。物体向远离地球、靠近月球的方向移动，可以减小地球引力（因为引力与距离的平方成反比），同时增大月球引力（距离月球更近），并且由于物体到旋转中心的距离 r增大，离心力ω^2r也会增大，从而重新达到力的平衡。

2. 除了L1点外，地球-月球系统还有其他拉格朗日点（L2-L5）。这些点的位置如何确定？它们各自有什么特点？

* L2 点：位于月球轨道外侧，距离地心R+r处（R为地月距离，r为月球半径）。其特点是在该点放置的物体可以在地球和月球的引力作用下，与地月系统保持相对静止。
* L3 点：位于地球另一侧，与月球关于地球对称的位置。由于受到太阳引力等多种因素的干扰，L3 点在实际应用中相对较少。但从理论上来说，在该点的物体也能在地球和月球的引力作用下保持相对平衡。
* L4 点和 L5 点：这两个点与地球、月球构成等边三角形。L4 点位于月球公转轨道的前方，L5 点位于月球公转轨道的后方。L4 和 L5 点具有引力稳定的特点，在这些位置存在大量的小天体，被称为特洛伊小行星。在这些点上，物体所受的地球和月球引力的合力提供了其绕地月系统质心旋转的向心力，使得物体能够稳定地存在于该位置。

## 5. 结论

总结本实验的主要发现和收获，包括对拉格朗日点物理意义的理解以及数值方法在天体力学问题中的应用。

* 本实验通过数值方法成功求解了地球 - 月球系统 L1 点位置（约3.26×10^8m，占地月距离 84.8%），验证了牛顿法和弦截法的有效性。L1 点的力学平衡特性使其成为空间任务的重要选址，而数值方法为天体力学问题提供了高效的求解工具。牛顿法收敛快但依赖导数和初值，弦截法鲁棒性强但收敛较慢，实际应用中需根据问题特性选择方法。

## 核心代码片段

请粘贴您实现的关键函数代码（如L1点位置方程和牛顿法实现），并简要说明代码的核心思路。

```
def lagrange_equation(r):
    """L1点位置方程：地球引力 - 月球引力 - 离心力 = 0"""
    earth_gravity = G * M / (r ** 2)
    moon_gravity = G * m / ((R - r) ** 2)
    centrifugal_force = omega ** 2 * r
    return earth_gravity - moon_gravity - centrifugal_force

def newton_method(f, df, x0, tol=1e-8, max_iter=100):
    """牛顿法迭代求解"""
    x = x0
    for i in range(max_iter):
        fx = f(x)
        if abs(fx) < tol:
            return x, i+1, True
        dfx = df(x)
        if abs(dfx) < 1e-14: break
        x = x - fx / dfx
    return x, max_iter, False
```

代码说明：
* lagrange_equation 实现力平衡方程，直接计算三项力的代数和。
* newton_method 通过迭代公式x = x - fx / dfx逼近根，每次迭代检查函数值和相对变化量是否满足收敛条件，确保精度和稳定性。
